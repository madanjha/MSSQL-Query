--Simple Queries:
--1. List all the employee details.
select * from employee;
--2. List all the department details.
Select * from Department;
--3. List all job details.
select * from job;
--4. List all the locations.
select * from location;
--5. List out the First Name, Last Name, Salary, Commission for all Employees.
select FIRST_NAME,LAST_NAME,SALARY,COMM from employee;
--6. List out the Employee ID, Last Name, Department ID for all employees and 
--alias --Employee ID as "ID of the Employee", Last Name as "Name of the --Employee", Department ID as "Dep_id".
select employee_id as "ID of the Employee",last_name as "Name of the Employee",  department_id as "Dep_id" from employee;
--7. List out the annual salary of the employees with their names only.
select concat(first_name,' ',last_name) as fullname, salary*12 as annual_salary from employee;
--WHERE Condition:
--1. List the details about "Smith".
select * from employee where last_name='Smith'
--2. List out the employees who are working in department 20.
select * from employee where department_id=20;
--3. List out the employees who are earning salary between 2000 and 3000.
select * from employee where salary between 2000 and 3000;
--4. List out the employees who are working in department 10 or 20.
select * from employee where department_id in (10,20);
--5. Find out the employees who are not working in department 10 or 30.
select * from employee where department_id not in(10,30);
--6. List out the employees whose name starts with 'L'.
select * from employee where first_name like 'L%';
--7. List out the employees whose name starts with 'L' and ends with 'E'.
select * from employee where first_name like 'L%E';
--8. List out the employees whose name length is 4 and start with 'J'.
select * from employee where len(first_name)=4 and first_name like 'j%';
--9. List out the employees who are working in department 30 and draw the 
--salaries more than 2500.
select * from employee where department_id=30 and salary >2500;
--10. List out the employees who are not receiving commission.
select * from employee where comm is null;
--ORDER BY Clause:
--1. List out the Employee ID and Last Name in ascending order based on the 
--Employee ID.
select employee_id, last_name from employee order by employee_id asc; 
--2. List out the Employee ID and Name in descending order based on salary.
select employee_id, last_name from employee order by salary desc;
--3. List out the employee details according to their Last Name in ascending-order.
select * from employee order by last_name asc;
--4. List out the employee details according to their Last Name in ascending 
--order and then Department ID in descending order.
select * from employee order by last_name;
select * from employee order by department_id desc;

--GROUP BY and HAVING Clause:
--1. List out the department wise maximum salary, minimum salary and 
--average salary of the employees.
select max(employee.salary) as max_salary,min(employee.salary) as min_salary, avg(employee.salary) as avg_salary--,name 
from  employee join department on employee.DEPARTMENT_ID=department.Department_Id group by name;
--2. List out the job wise maximum salary, minimum salary and average 
--salary of the employees.
select max(employee.salary) as max_salary,min(employee.salary) as min_salary, avg(employee.salary) as avg_salary--,Designation 
from  employee join JOB on employee.JOB_ID=JOB.Job_ID group by Designation;
--3. List out the number of employees who joined each month in ascending order.
select count(*) as num_of_employee from employee where MONTH(hire_date) between 1 and 12 group by MONTH(hire_date); 
--4. List out the number of employees for each month and year in 
--ascending order based on the year and month.
select count(*) num_of_employee from employee where MONTH(hire_date) between 1 and 12 
group by hire_date order by hire_date ;
--5. List out the Department ID having at least four employees.

--6. How many employees joined in February month.
--7. How many employees joined in May or June month.
select count(*) from employee where MONTH(hire_date) in (5,6)
--8. How many employees joined in 1985?
select count(*) as num_of_employee from employee where YEAR(hire_date)=1985;
--9. How many employees joined each month in 1985?
select MONTH(hire_date) as month_of_year, count(*) as num_of_employee from employee where YEAR(hire_date)=1985 group by MONTH(hire_date);
--10. How many employees were joined in April 1985?
select count(*) from employee where YEAR(hire_date)=1985 and MONTH(hire_date)=4
--11. Which is the Department ID having greater than or equal to 3 employees 
--joining in April 1985
select department_id from employee where YEAR(hire_date)=1985 and MONTH(hire_date)=4 group by department_id having count(*)>=3;

--Joins:
--1. List out employees with their department names.
--2. Display employees with their designations.
--3. Display the employees with their department names and city.
--4. How many employees are working in different departments? Display with 
--department names.
select * from employee;
go
select * from department;
go
select * from Location;
--5. How many employees are working in the sales department?
select count(*) as num_of_employe from employee join department on employee.department_id=department.department_id where name='sales';
--6. Which is the department having greater than or equal to 3 
--employees and display the department names in
--ascending order.
select name from emaployee join department on employee.department_id=department.department_id group by name  
having count(*) >=3 order by name;
--7. How many employees are working in 'Dallas'?
--8. Display all employees in sales or operation departments.

--CONDITIONAL STATEMENT
1. Display the employee details with salary grades. Use conditional statement to
create a grade column.
2. List out the number of employees grade wise. Use conditional statement to
create a grade column.
3. Display the employee salary grades and the number of employees between
2000 to 5000 range of salary


--Subqueries:
--1. Display the employees list who got the maximum salary.
--2. Display the employees who are working in the sales department.
--3. Display the employees who are working as 'Clerk'.
--4. Display the list of employees who are living in 'Boston'.
--5. Find out the number of employees working in the sales department.
--6. Update the salaries of employees who are working as clerks on the basis of 
--10%.
--7. Display the second highest salary drawing employee details.
select * from employee where salary = (select max(salary) from employee where salary < (select max(salary) from employee));

select * from ( select *,dense_rank() over (order by salary desc) as rank from employee) as ranking where rank=2;

--8. List out the employees who earn more than every employee in department 30.
--9. Find out which department has no employees.
--10. Find out the employees who earn greater than the average salary for 
--their department
select * from employee where salary> (select avg(salary) from employee);
